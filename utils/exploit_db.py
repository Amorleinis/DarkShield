import requests
from datetime import datetime, timedelta

def get_recent_exploits(days_back=7):
    try:
        # Note: This is a simulated API endpoint
        url = "https://exploit-db.com/api/exploits"
        params = {
            "start_date": (datetime.now() - timedelta(days=days_back)).strftime("%Y-%m-%d"),
            "end_date": datetime.now().strftime("%Y-%m-%d")
        }
        
        response = requests.get(url, params=params)
        if response.status_code == 200:
            data = response.json()
            exploits = []
            for exploit in data.get('exploits', []):
                exploits.append([
                    exploit.get('id'),
                    exploit.get('title'),
                    exploit.get('type'),
                    exploit.get('platform'),
                    exploit.get('date')
                ])
            return exploits
        return None
    except Exception as e:
        st.error(f"Error fetching Exploit-DB data: {str(e)}")
        return None
